import pandas as pd
import matplotlib.pyplot as plt # Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ´Ğ»Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ²

print("ğŸ§¹ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµĞ¼ Ğ³ĞµĞ½ĞµÑ€Ğ°Ğ»ÑŒĞ½ÑƒÑ ÑƒĞ±Ğ¾Ñ€ĞºÑƒ...")

# 1. Ğ§Ğ¸Ñ‚Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ñ‚Ğ²Ğ¾ĞµĞ¹ Ñ‚ÑĞ¶ĞµĞ»Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
df = pd.read_csv('final_timeline.csv')

# 2. ĞŸÑ€ĞµĞ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºÑƒ year Ğ² Ñ‡Ğ¸ÑĞ»Ğ° (ĞµÑĞ»Ğ¸ Ñ‚Ğ°Ğ¼ Ğ±Ñ‹Ğ» Ğ¼ÑƒÑĞ¾Ñ€, Ğ¾Ğ½ ÑÑ‚Ğ°Ğ½ĞµÑ‚ NaN)
df['year'] = pd.to_numeric(df['year'], errors='coerce')

# 3. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ "Ğ—Ğ´Ñ€Ğ°Ğ²Ğ¾Ğ³Ğ¾ ÑĞ¼Ñ‹ÑĞ»Ğ°"
# Ğ‘ĞµÑ€ĞµĞ¼ ĞºĞ½Ğ¸Ğ³Ğ¸ Ğ¾Ñ‚ Ğ“ÑƒÑ‚ĞµĞ½Ğ±ĞµÑ€Ğ³Ğ° (1450) Ğ´Ğ¾ ÑĞµĞ³Ğ¾Ğ´Ğ½ÑÑˆĞ½ĞµĞ³Ğ¾ Ğ´Ğ½Ñ (2025)
clean_df = df[ (df['year'] >= 1850) & (df['year'] <= 2025) ].copy()

# 4. Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ Ğ³Ğ¾Ğ´Ğ°Ğ¼ (Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾Ğ³Ğ¾ Ğº Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ĞµĞ¼Ñƒ)
clean_df = clean_df.sort_values('year')

print("\n--- Ğ¢ĞĞŸ-10 Ğ¡ĞĞœĞ«Ğ¥ 'Ğ£Ğ ĞĞ–ĞĞ™ĞĞ«Ğ¥' Ğ›Ğ•Ğ¢ ---")
# Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ñƒ ĞºĞ½Ğ¸Ğ³, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ñ€ĞµĞºĞ¾Ñ€Ğ´ÑĞ¼ĞµĞ½Ğ¾Ğ²
print(clean_df.sort_values('books_count', ascending=False).head(10))

print("\n--- Ğ“Ğ ĞĞ¤Ğ˜Ğš ---")
# Ğ Ğ¸ÑÑƒĞµĞ¼ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² ĞºĞ¾Ğ´Ğµ
plt.figure(figsize=(12, 6))
plt.plot(clean_df['year'], clean_df['books_count'], color='blue', linewidth=2)
plt.title('Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµÑ‡ĞµÑÑ‚Ğ²Ğ° Ñ‡ĞµÑ€ĞµĞ· ĞºĞ½Ğ¸Ğ³Ğ¸ (Open Library)', fontsize=16)
plt.xlabel('Ğ“Ğ¾Ğ´', fontsize=12)
plt.ylabel('ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¸Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… ĞºĞ½Ğ¸Ğ³', fontsize=12)
plt.grid(True, alpha=0.3)

# Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºÑƒ
plt.savefig('history_chart.png')
print("ğŸ–¼ï¸ Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ Ğ² Ñ„Ğ°Ğ¹Ğ» 'history_chart.png'. ĞÑ‚ĞºÑ€Ğ¾Ğ¹ ĞµĞ³Ğ¾!")