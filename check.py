import duckdb

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ DuckDB
con = duckdb.connect()

print("üöÄ –ù–∞—á–∏–Ω–∞—é —á—Ç–µ–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ Ryzen 7800x3d...")

# –í–ù–ò–ú–ê–ù–ò–ï: –ò–º—è —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–æ —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ —É —Ç–µ–±—è –≤ –ø–∞–ø–∫–µ
filename = 'ol_dump_works_2025-12-31.txt.gz'

# SQL –∑–∞–ø—Ä–æ—Å. –ú—ã –≥–æ–≤–æ—Ä–∏–º: 
# "–ß–∏—Ç–∞–π CSV (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ç–∞–±), –∏–≥–Ω–æ—Ä–∏—Ä—É–π –æ—à–∏–±–∫–∏ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–∞–π –º–Ω–µ –∫–æ–ª–æ–Ω–∫—É —Å JSON"
query = f"""
SELECT column4 as json_data
FROM read_csv(
    '{filename}', 
    header=False, 
    delim='\\t', 
    quote='', 
    escape=''
) 
LIMIT 3;
"""

try:
    # –ó–∞—Å–µ–∫–∞–µ–º –≤—Ä–µ–º—è, —á—Ç–æ–±—ã —Ç—ã –∫–∞–π—Ñ–∞–Ω—É–ª –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–≤–æ–µ–≥–æ –ü–ö
    import time
    start = time.time()
    
    result = con.execute(query).df()
    
    end = time.time()
    print(f"‚úÖ –ì–æ—Ç–æ–≤–æ –∑–∞ {end - start:.4f} —Å–µ–∫—É–Ω–¥!") 
    print("\n–í–æ—Ç —á—Ç–æ –º—ã –¥–æ—Å—Ç–∞–ª–∏ (–ø–µ—Ä–≤—ã–µ 3 –∫–Ω–∏–≥–∏):")
    print(result)

except Exception as e:
    print("‚ùå –û—à–∏–±–∫–∞:", e)